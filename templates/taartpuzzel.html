<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taartpuzzle Game</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/taartpuzzel.css') }}">
</head>
<body>
    <div class="container">
        <h1>Taartpuzzle Game</h1>
        <div class="new-game-section">
            <form action="{{ url_for('new_taartpuzzel') }}" method="get">

                <div class="player-name-section">
                    <label for="playername">Player Name:</label>
                    <input type="text" id="playername" name="playername" maxlength="15" placeholder="Enter your name">
                    <div class="tooltip">
                        <span class="info-icon">ℹ️</span>
                        <span class="tooltiptext">Enter your name here. It will be saved in your browser for your next visit! It will also be saved to the database. This field is optional and may be left empty.</span>
                    </div>
                </div>
                <button type="submit">New Game</button>
            </form>
        </div>

        <svg viewBox="0 0 500 500">
            <!-- Outer circle -->
            <circle cx="50%" cy="50%" r="50%" fill="red"/>
            <!-- Inner circle -->
            <circle cx="50%" cy="50%" r="10%" fill="red" stroke="white" stroke-width="5" />
            <!-- Lines dividing the segments -->
            <g stroke="white" stroke-width="4">
                <line x1="50%" y1="0%" x2="50%" y2="40%" />
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(40 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(80 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(120 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(160 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(200 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(240 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(280 250 250)"/>
                <line x1="50%" y1="0%" x2="50%" y2="40%" transform="rotate(320 250 250)"/>
            </g>
            <!-- Central text -->
            <text x="50%" y="47.5%" font-size="30" text-anchor="middle" fill="white" dy="15">2V</text>
            <text x="50%" y="52.5%" font-size="30" text-anchor="middle" fill="white" dy="15">12</text>

            <!-- Letters in the segments -->
            <!-- Python code to calculate the position of each letter
            import numpy as np

            n_letters = 9
            pct_of_seg = 0.7

            for i in range(n_letters):
                angle_deg = (i + 0.5) * 40

                x = np.sin(np.deg2rad(angle_deg)) * pct_of_seg
                y = np.cos(np.deg2rad(angle_deg)) * pct_of_seg
                print(i, 0.5 + 0.5 * x, 0.5 - 0.5 * y) -->
            <text x="62%" y="17.1%" id="letter1" class="letter {% if letters[0] == '?' %}unknown{% else %}known{% endif %}">{{ letters[0] }}</text>
            <text x="80.3%" y="32.5%" id="letter2" class="letter {% if letters[1] == '?' %}unknown{% else %}known{% endif %}">{{ letters[1] }}</text>
            <text x="84.5%" y="56.1%" id="letter3" class="letter {% if letters[2] == '?' %}unknown{% else %}known{% endif %}">{{ letters[2] }}</text>
            <text x="72.5%" y="76.8%" id="letter4" class="letter {% if letters[3] == '?' %}unknown{% else %}known{% endif %}">{{ letters[3] }}</text>
            <text x="50%" y="85%" id="letter5" class="letter {% if letters[4] == '?' %}unknown{% else %}known{% endif %}">{{ letters[4] }}</text>
            <text x="27.5%" y="76.8%" id="letter6" class="letter {% if letters[5] == '?' %}unknown{% else %}known{% endif %}">{{ letters[5] }}</text>
            <text x="15.5%" y="56.1%" id="letter7" class="letter {% if letters[6] == '?' %}unknown{% else %}known{% endif %}">{{ letters[6] }}</text>
            <text x="19.7%" y="32.5%" id="letter8" class="letter {% if letters[7] == '?' %}unknown{% else %}known{% endif %}">{{ letters[7] }}</text>
            <text x="38%" y="17.1%" id="letter9" class="letter {% if letters[8] == '?' %}unknown{% else %}known{% endif %}">{{ letters[8] }}</text>
        </svg>

        <form action="{{ url_for('guess_taartpuzzel') }}" method="post" id="guessTaartpuzzel">
            <input type="text" id="guessInput" name="guess" placeholder="Enter your guess" maxlength="12">
            <input type="submit" value="Submit Guess">
        </form>
        <div id="result">
            {% if result %}
                <p>{{ result }}</p>
            {% endif %}
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load player name from local storage
            const playerNameInput = document.getElementById('playername');
            const savedName = localStorage.getItem('playerName');
            if (savedName) {
                playerNameInput.value = savedName;
            }

            playerNameInput.addEventListener('blur', () => {
                localStorage.setItem('playerName', playerNameInput.value);
            });
        });
    </script>
</body>
</html>
